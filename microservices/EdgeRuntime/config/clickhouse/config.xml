<?xml version="1.0"?>
<!-- ClickHouse Custom Configuration for EdgeRuntime -->
<clickhouse>
    <logger>
        <level>warning</level>
        <log>/var/log/clickhouse-server/clickhouse-server.log</log>
        <errorlog>/var/log/clickhouse-server/clickhouse-server.err.log</errorlog>
        <size>100M</size>
        <count>5</count>
    </logger>

    <!-- Performance tuning for ISP accounting workload -->
    <max_connections>200</max_connections>
    <max_concurrent_queries>100</max_concurrent_queries>

    <!-- Memory limits -->
    <max_server_memory_usage_to_ram_ratio>0.8</max_server_memory_usage_to_ram_ratio>

    <!-- Merge tree settings optimized for time-series accounting data -->
    <merge_tree>
        <max_bytes_to_merge_at_max_space_in_pool>161061273600</max_bytes_to_merge_at_max_space_in_pool>
        <max_bytes_to_merge_at_min_space_in_pool>1048576</max_bytes_to_merge_at_min_space_in_pool>
        <parts_to_delay_insert>150</parts_to_delay_insert>
        <parts_to_throw_insert>300</parts_to_throw_insert>
    </merge_tree>

    <!-- Mark cache for faster reads -->
    <mark_cache_size>5368709120</mark_cache_size>

    <!-- Listen on all interfaces -->
    <listen_host>::</listen_host>
</clickhouse>
